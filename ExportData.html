<!DOCTYPE html>
<html>

<head>
    <title>Export Firestore Data</title>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
        import * as XLSX from "https://cdn.jsdelivr.net/npm/xlsx@0.18.5/+esm";

        // Your Firebase config
        const firebaseConfig = {
            apiKey: "AIzaSyDSnENpfbQVD5i-o_Dq1bbh04YHCFz7dpw",
            authDomain: "data-edit-adbcb.firebaseapp.com",
            projectId: "data-edit-adbcb",
            storageBucket: "data-edit-adbcb.firebasestorage.app",
            messagingSenderId: "89538533125",
            appId: "1:89538533125:web:b0f24d3d44ebd50b16896c",
            measurementId: "G-ZH1BCCKTGF"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        async function downloadExcel() {
            try {
                const querySnapshot = await getDocs(collection(db, "excel"));
                if (querySnapshot.empty) {
                    alert("No data found!");
                    return;
                }

                const docs = [];
                querySnapshot.forEach((doc) => {
                    docs.push(doc.data());
                });

                // ✅ Define your header order here
                const headers = ["Serial",
                    "Section No.",
                    "System Default / Keywords",
                    "Equippment / Subsections",
                    "Sections"];

                const data = docs.map((doc) => headers.map((h) => doc[h] || ""));
                data.unshift(headers);

                const ws = XLSX.utils.aoa_to_sheet(data);
                const wb = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(wb, ws, "Export");

                XLSX.writeFile(wb, "FirestoreData.xlsx");
            } catch (error) {
                console.error("Error exporting data:", error);
            }
        }

        // ✅ Expose function to HTML button
        window.downloadExcel = downloadExcel;
    </script>
</head>

<body>
    <h2>Export Firestore Data</h2>
    <button onclick="downloadExcel()">Download Excel</button>
</body>

</html>



<!-- 
"serial",
"Section No.",
"System Default / Keywords",
"Equippment / Subsections",
"Sections" -->